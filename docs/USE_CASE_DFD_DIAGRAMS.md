# SƠ ĐỒ USE CASE VÀ LUỒNG DỮ LIỆU

## HỆ THỐNG QUẢN LÝ DỰ ÁN TASKFLOW

---

# PHẦN 1: SƠ ĐỒ USE CASE (USE CASE DIAGRAMS)

## 1.1. SƠ ĐỒ USE CASE TỔNG QUAN HỆ THỐNG

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                                    HỆ THỐNG QUẢN LÝ DỰ ÁN TASKFLOW                                         │
│                                                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                                                     │   │
│  │                                                                                                     │   │
│  │     ┌─────────────────────┐          ┌─────────────────────┐          ┌─────────────────────┐      │   │
│  │     │                     │          │                     │          │                     │      │   │
│  │     │   QUẢN LÝ TÀI KHOẢN │          │   QUẢN LÝ DỰ ÁN    │          │  QUẢN LÝ CÔNG VIỆC  │      │   │
│  │     │                     │          │                     │          │                     │      │   │
│  │     │  ○ Đăng nhập        │          │  ○ Xem danh sách    │          │  ○ Xem Kanban Board │      │   │
│  │     │  ○ Đăng ký          │          │  ○ Tạo dự án        │          │  ○ Tạo công việc    │      │   │
│  │     │  ○ Đăng xuất        │          │  ○ Sửa dự án        │          │  ○ Sửa công việc    │      │   │
│  │     │  ○ Quên mật khẩu    │          │  ○ Xóa dự án        │          │  ○ Xóa công việc    │      │   │
│  │     │  ○ Đổi mật khẩu     │          │  ○ Quản lý thành viên│          │  ○ Kéo thả task     │      │   │
│  │     │  ○ Cập nhật profile │          │  ○ Theo dõi tiến độ │          │  ○ Giao việc        │      │   │
│  │     │                     │          │                     │          │  ○ Checklist        │      │   │
│  │     └──────────┬──────────┘          └──────────┬──────────┘          │  ○ Bình luận        │      │   │
│  │                │                                │                     └──────────┬──────────┘      │   │
│  │                │                                │                                │                  │   │
│  │                │                                │                                │                  │   │
│  │     ┌──────────┴──────────┐          ┌──────────┴──────────┐          ┌──────────┴──────────┐      │   │
│  │     │                     │          │                     │          │                     │      │   │
│  │     │   QUẢN LÝ TÀI LIỆU  │          │   QUẢN LÝ LỊCH      │          │   BÁO CÁO THỐNG KÊ  │      │   │
│  │     │                     │          │                     │          │                     │      │   │
│  │     │  ○ Upload file      │          │  ○ Xem lịch         │          │  ○ Dashboard        │      │   │
│  │     │  ○ Tạo thư mục      │          │  ○ Tạo sự kiện      │          │  ○ Biểu đồ tiến độ  │      │   │
│  │     │  ○ Download file    │          │  ○ Sửa sự kiện      │          │  ○ Thống kê tasks   │      │   │
│  │     │  ○ Chia sẻ tài liệu │          │  ○ Xóa sự kiện      │          │  ○ Export báo cáo   │      │   │
│  │     │  ○ Đánh dấu sao     │          │  ○ Mời tham dự      │          │                     │      │   │
│  │     │                     │          │                     │          │                     │      │   │
│  │     └─────────────────────┘          └─────────────────────┘          └─────────────────────┘      │   │
│  │                                                                                                     │   │
│  │                                      ┌─────────────────────┐                                        │   │
│  │                                      │                     │                                        │   │
│  │                                      │   QUẢN TRỊ HỆ THỐNG │                                        │   │
│  │                                      │      (Admin)        │                                        │   │
│  │                                      │                     │                                        │   │
│  │                                      │  ○ Quản lý users    │                                        │   │
│  │                                      │  ○ Cài đặt hệ thống │                                        │   │
│  │                                      │  ○ Xem activity logs│                                        │   │
│  │                                      │  ○ Backup dữ liệu   │                                        │   │
│  │                                      │                     │                                        │   │
│  │                                      └─────────────────────┘                                        │   │
│  │                                                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                             │
│                                                                                                             │
│        ┌───────┐              ┌───────┐              ┌───────┐              ┌───────┐                       │
│        │       │              │       │              │       │              │       │                       │
│        │ Guest │              │Member │              │Manager│              │ Admin │                       │
│        │       │              │       │              │       │              │       │                       │
│        └───┬───┘              └───┬───┘              └───┬───┘              └───┬───┘                       │
│            │                      │                      │                      │                           │
│            │                      │                      │                      │                           │
│            └──────────────────────┴──────────────────────┴──────────────────────┘                           │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘


ACTORS (Tác nhân):
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  Guest   : Khách chưa đăng nhập - Chỉ có thể đăng nhập, đăng ký, quên mật khẩu     │
│  Member  : Thành viên - Tạo/sửa tasks, documents của mình                           │
│  Manager : Quản lý - Quản lý dự án, nhóm, xem báo cáo                               │
│  Admin   : Quản trị viên - Toàn quyền hệ thống                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```


---

## 1.2. USE CASE: QUẢN LÝ TÀI KHOẢN (Authentication)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                              QUẢN LÝ TÀI KHOẢN                                      │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │                     │                             │   │
│  │            ┌───────────>│     UC01: Đăng nhập │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<extend>>                             │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │  UC02: Remember Me  │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│    UC03: Đăng ký    │                             │   │
│  │            │            │                     │                             │   │
│  │  ┌─────┐   │            └─────────────────────┘                             │   │
│  │  │     │   │                                                                │   │
│  │  │Guest│───┤            ┌─────────────────────┐                             │   │
│  │  │     │   │            │                     │                             │   │
│  │  └─────┘   ├───────────>│  UC04: Quên mật khẩu│                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<include>>                            │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │  UC05: Gửi email    │                             │   │
│  │            │            │       reset         │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            └───────────>│UC06: Reset mật khẩu │                             │   │
│  │                         │                     │                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  │  ┌─────┐                ┌─────────────────────┐                             │   │
│  │  │     │                │                     │                             │   │
│  │  │User │───────────────>│   UC07: Đăng xuất   │                             │   │
│  │  │     │                │                     │                             │   │
│  │  └──┬──┘                └─────────────────────┘                             │   │
│  │     │                                                                       │   │
│  │     │                   ┌─────────────────────┐                             │   │
│  │     │                   │                     │                             │   │
│  │     ├──────────────────>│  UC08: Đổi mật khẩu │                             │   │
│  │     │                   │                     │                             │   │
│  │     │                   └─────────────────────┘                             │   │
│  │     │                                                                       │   │
│  │     │                   ┌─────────────────────┐                             │   │
│  │     │                   │                     │                             │   │
│  │     └──────────────────>│UC09: Cập nhật profile│                            │   │
│  │                         │                     │                             │   │
│  │                         └──────────┬──────────┘                             │   │
│  │                                    │                                        │   │
│  │                                    │ <<extend>>                             │   │
│  │                                    ▼                                        │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │  UC10: Upload avatar│                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### Đặc tả Use Case UC01: Đăng nhập

| Thuộc tính | Mô tả |
|------------|-------|
| **Mã UC** | UC01 |
| **Tên** | Đăng nhập |
| **Actor** | Guest |
| **Mô tả** | Người dùng đăng nhập vào hệ thống bằng email và mật khẩu |
| **Tiền điều kiện** | Người dùng đã có tài khoản trong hệ thống |
| **Hậu điều kiện** | Người dùng được xác thực và chuyển đến Dashboard |

**Luồng chính (Main Flow):**
1. Guest truy cập trang đăng nhập
2. Hệ thống hiển thị form đăng nhập (email, password, remember me)
3. Guest nhập email và mật khẩu
4. Guest nhấn nút "Đăng nhập"
5. Hệ thống validate dữ liệu đầu vào
6. Hệ thống kiểm tra email tồn tại trong database
7. Hệ thống verify password bằng bcrypt
8. Hệ thống kiểm tra tài khoản có bị khóa không
9. Hệ thống tạo session và regenerate session ID
10. Hệ thống cập nhật last_login_at
11. Hệ thống redirect đến Dashboard

**Luồng thay thế (Alternative Flow):**
- **5a.** Dữ liệu không hợp lệ: Hiển thị thông báo lỗi validation
- **6a.** Email không tồn tại: Hiển thị "Email hoặc mật khẩu không đúng"
- **7a.** Password sai: Hiển thị "Email hoặc mật khẩu không đúng"
- **8a.** Tài khoản bị khóa: Hiển thị "Tài khoản đã bị khóa"

**Luồng mở rộng (Extension):**
- **UC02 Remember Me:** Nếu chọn "Ghi nhớ đăng nhập", tạo remember token và lưu cookie 30 ngày

---

## 1.3. USE CASE: QUẢN LÝ DỰ ÁN (Project Management)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                                QUẢN LÝ DỰ ÁN                                        │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │                     │                             │   │
│  │            ┌───────────>│UC11: Xem danh sách  │                             │   │
│  │            │            │      dự án          │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC12: Xem chi tiết   │                             │   │
│  │            │            │      dự án          │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<include>>                            │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │UC13: Xem tiến độ    │                             │   │
│  │            │            │      dự án          │                             │   │
│  │  ┌──────┐  │            └─────────────────────┘                             │   │
│  │  │      │  │                                                                │   │
│  │  │Member│──┤            ┌─────────────────────┐                             │   │
│  │  │      │  │            │                     │                             │   │
│  │  └──────┘  ├───────────>│UC14: Tạo dự án mới  │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<include>>                            │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │UC15: Thêm owner     │                             │   │
│  │            │            │      vào dự án      │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            └───────────>│UC16: Tìm kiếm dự án │                             │   │
│  │                         │                     │                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  │  ┌──────┐               ┌─────────────────────┐                             │   │
│  │  │      │               │                     │                             │   │
│  │  │Manager│─────────────>│UC17: Sửa dự án      │                             │   │
│  │  │      │               │                     │                             │   │
│  │  └──┬───┘               └─────────────────────┘                             │   │
│  │     │                                                                       │   │
│  │     │                   ┌─────────────────────┐                             │   │
│  │     │                   │                     │                             │   │
│  │     ├──────────────────>│UC18: Quản lý thành  │                             │   │
│  │     │                   │      viên dự án     │                             │   │
│  │     │                   └──────────┬──────────┘                             │   │
│  │     │                              │                                        │   │
│  │     │              ┌───────────────┼───────────────┐                        │   │
│  │     │              │               │               │                        │   │
│  │     │              ▼               ▼               ▼                        │   │
│  │     │   ┌─────────────────┐ ┌─────────────┐ ┌─────────────────┐             │   │
│  │     │   │UC19: Thêm       │ │UC20: Xóa    │ │UC21: Đổi role   │             │   │
│  │     │   │     thành viên  │ │   thành viên│ │     thành viên  │             │   │
│  │     │   └─────────────────┘ └─────────────┘ └─────────────────┘             │   │
│  │     │                                                                       │   │
│  │     │                   ┌─────────────────────┐                             │   │
│  │     │                   │                     │                             │   │
│  │     └──────────────────>│UC22: Chuyển quyền   │                             │   │
│  │                         │      sở hữu         │                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  │  ┌──────┐               ┌─────────────────────┐                             │   │
│  │  │      │               │                     │                             │   │
│  │  │Admin │──────────────>│UC23: Xóa dự án      │                             │   │
│  │  │      │               │                     │                             │   │
│  │  └──────┘               └─────────────────────┘                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```


---

## 1.4. USE CASE: QUẢN LÝ CÔNG VIỆC (Task Management)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                              QUẢN LÝ CÔNG VIỆC                                      │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │                     │                             │   │
│  │            ┌───────────>│UC24: Xem Kanban     │                             │   │
│  │            │            │      Board          │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC25: Xem danh sách  │                             │   │
│  │            │            │      công việc      │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC26: Xem chi tiết   │                             │   │
│  │            │            │      công việc      │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │            ┌──────────┼──────────┬──────────┐                  │   │
│  │            │            │          │          │          │                  │   │
│  │            │            ▼          ▼          ▼          ▼                  │   │
│  │            │     ┌───────────┐┌─────────┐┌─────────┐┌─────────┐            │   │
│  │            │     │UC27: Xem  ││UC28: Xem││UC29: Xem││UC30: Xem│            │   │
│  │            │     │ checklist ││comments ││assignees││ labels  │            │   │
│  │            │     └───────────┘└─────────┘└─────────┘└─────────┘            │   │
│  │  ┌──────┐  │                                                                │   │
│  │  │      │  │            ┌─────────────────────┐                             │   │
│  │  │Member│──┤            │                     │                             │   │
│  │  │      │  ├───────────>│UC31: Tạo công việc  │                             │   │
│  │  └──────┘  │            │                     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC32: Sửa công việc  │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<extend>>                             │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │UC33: Kéo thả task   │                             │   │
│  │            │            │   (Drag & Drop)     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC34: Quản lý        │                             │   │
│  │            │            │      Checklist      │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │            ┌──────────┼──────────┬──────────┐                  │   │
│  │            │            ▼          ▼          ▼          ▼                  │   │
│  │            │     ┌───────────┐┌─────────┐┌─────────┐┌─────────┐            │   │
│  │            │     │UC35: Thêm ││UC36: Sửa││UC37: Xóa││UC38:    │            │   │
│  │            │     │   item    ││  item   ││  item   ││Toggle   │            │   │
│  │            │     └───────────┘└─────────┘└─────────┘└─────────┘            │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC39: Bình luận      │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │            ┌──────────┼──────────┬──────────┐                  │   │
│  │            │            ▼          ▼          ▼          ▼                  │   │
│  │            │     ┌───────────┐┌─────────┐┌─────────┐┌─────────┐            │   │
│  │            │     │UC40: Thêm ││UC41: Sửa││UC42: Xóa││UC43:    │            │   │
│  │            │     │  comment  ││ comment ││ comment ││Reply    │            │   │
│  │            │     └───────────┘└─────────┘└─────────┘└────┬────┘            │   │
│  │            │                                             │                  │   │
│  │            │                                             │ <<extend>>       │   │
│  │            │                                             ▼                  │   │
│  │            │                                      ┌─────────────┐           │   │
│  │            │                                      │UC44: Nested │           │   │
│  │            │                                      │    Replies  │           │   │
│  │            │                                      └─────────────┘           │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            └───────────>│UC45: Giao việc      │                             │   │
│  │                         │                     │                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  │  ┌──────┐               ┌─────────────────────┐                             │   │
│  │  │      │               │                     │                             │   │
│  │  │Manager│─────────────>│UC46: Xóa công việc  │                             │   │
│  │  │      │               │                     │                             │   │
│  │  └──────┘               └─────────────────────┘                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### Đặc tả Use Case UC31: Tạo công việc

| Thuộc tính | Mô tả |
|------------|-------|
| **Mã UC** | UC31 |
| **Tên** | Tạo công việc mới |
| **Actor** | Member, Manager, Admin |
| **Mô tả** | Người dùng tạo công việc mới trong dự án |
| **Tiền điều kiện** | Người dùng đã đăng nhập và có quyền tasks.create |
| **Hậu điều kiện** | Công việc được tạo và hiển thị trong Kanban Board |

**Luồng chính:**
1. User nhấn nút "Tạo công việc mới"
2. Hệ thống hiển thị form tạo task
3. User nhập thông tin: tiêu đề, mô tả, dự án, độ ưu tiên, ngày hết hạn
4. User nhấn "Lưu"
5. Hệ thống validate dữ liệu
6. Hệ thống tạo UUID cho task
7. Hệ thống lưu task vào database
8. Hệ thống ghi activity log
9. Hệ thống hiển thị thông báo thành công
10. Hệ thống chuyển đến trang chi tiết task

---

## 1.5. USE CASE: QUẢN LÝ TÀI LIỆU (Document Management)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                              QUẢN LÝ TÀI LIỆU                                       │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │                     │                             │   │
│  │            ┌───────────>│UC47: Xem danh sách  │                             │   │
│  │            │            │      tài liệu       │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC48: Xem chi tiết   │                             │   │
│  │            │            │      tài liệu       │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC49: Download file  │                             │   │
│  │  ┌──────┐  │            │                     │                             │   │
│  │  │      │  │            └─────────────────────┘                             │   │
│  │  │Member│──┤                                                                │   │
│  │  │      │  │            ┌─────────────────────┐                             │   │
│  │  └──────┘  │            │                     │                             │   │
│  │            ├───────────>│UC50: Upload file    │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │                       │ <<include>>                            │   │
│  │            │                       ▼                                        │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │UC51: Validate file  │                             │   │
│  │            │            │  (type, size)       │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC52: Tạo thư mục    │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC53: Đánh dấu sao   │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            └───────────>│UC54: Chia sẻ tài liệu│                            │   │
│  │                         │                     │                             │   │
│  │                         └──────────┬──────────┘                             │   │
│  │                                    │                                        │   │
│  │                         ┌──────────┼──────────┐                             │   │
│  │                         ▼          ▼          ▼                             │   │
│  │                  ┌───────────┐┌─────────┐┌─────────┐                        │   │
│  │                  │UC55: Share││UC56: Đổi││UC57: Hủy│                        │   │
│  │                  │  với user ││permission││  share  │                        │   │
│  │                  └───────────┘└─────────┘└─────────┘                        │   │
│  │                                                                             │   │
│  │  ┌──────┐               ┌─────────────────────┐                             │   │
│  │  │      │               │                     │                             │   │
│  │  │Manager│─────────────>│UC58: Xóa tài liệu   │                             │   │
│  │  │      │               │                     │                             │   │
│  │  └──────┘               └─────────────────────┘                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```


---

## 1.6. USE CASE: QUẢN TRỊ HỆ THỐNG (Admin)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│                              QUẢN TRỊ HỆ THỐNG                                      │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                             │   │
│  │                         ┌─────────────────────┐                             │   │
│  │                         │                     │                             │   │
│  │            ┌───────────>│UC59: Xem Dashboard  │                             │   │
│  │            │            │      Admin          │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC60: Quản lý Users  │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └──────────┬──────────┘                             │   │
│  │            │                       │                                        │   │
│  │            │            ┌──────────┼──────────┬──────────┬──────────┐       │   │
│  │            │            ▼          ▼          ▼          ▼          ▼       │   │
│  │            │     ┌─────────┐┌─────────┐┌─────────┐┌─────────┐┌─────────┐   │   │
│  │            │     │UC61:    ││UC62:    ││UC63:    ││UC64:    ││UC65:    │   │   │
│  │            │     │Xem list ││Tạo user ││Sửa user ││Xóa user ││Khóa/Mở │   │   │
│  │            │     │users    ││         ││         ││         ││  user   │   │   │
│  │            │     └─────────┘└─────────┘└─────────┘└─────────┘└─────────┘   │   │
│  │  ┌──────┐  │                                                                │   │
│  │  │      │  │            ┌─────────────────────┐                             │   │
│  │  │Admin │──┤            │                     │                             │   │
│  │  │      │  ├───────────>│UC66: Quản lý tất cả │                             │   │
│  │  └──────┘  │            │      Projects       │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC67: Quản lý tất cả │                             │   │
│  │            │            │      Tasks          │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC68: Cài đặt hệ thống│                            │   │
│  │            │            │                     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC69: Xem Activity   │                             │   │
│  │            │            │      Logs           │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            ├───────────>│UC70: Backup dữ liệu │                             │   │
│  │            │            │                     │                             │   │
│  │            │            └─────────────────────┘                             │   │
│  │            │                                                                │   │
│  │            │            ┌─────────────────────┐                             │   │
│  │            │            │                     │                             │   │
│  │            └───────────>│UC71: Export báo cáo │                             │   │
│  │                         │                     │                             │   │
│  │                         └─────────────────────┘                             │   │
│  │                                                                             │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 1.7. BẢNG TỔNG HỢP USE CASE

| Mã UC | Tên Use Case | Actor | Mô tả |
|-------|--------------|-------|-------|
| **Authentication** |
| UC01 | Đăng nhập | Guest | Xác thực người dùng |
| UC02 | Remember Me | Guest | Ghi nhớ đăng nhập |
| UC03 | Đăng ký | Guest | Tạo tài khoản mới |
| UC04 | Quên mật khẩu | Guest | Yêu cầu reset password |
| UC05 | Gửi email reset | System | Gửi link reset password |
| UC06 | Reset mật khẩu | Guest | Đặt lại mật khẩu |
| UC07 | Đăng xuất | User | Thoát khỏi hệ thống |
| UC08 | Đổi mật khẩu | User | Thay đổi mật khẩu |
| UC09 | Cập nhật profile | User | Sửa thông tin cá nhân |
| UC10 | Upload avatar | User | Tải ảnh đại diện |
| **Project Management** |
| UC11 | Xem danh sách dự án | Member | Xem các dự án tham gia |
| UC12 | Xem chi tiết dự án | Member | Xem thông tin dự án |
| UC13 | Xem tiến độ dự án | Member | Xem progress |
| UC14 | Tạo dự án mới | Member | Tạo project mới |
| UC15 | Thêm owner | System | Tự động thêm creator làm owner |
| UC16 | Tìm kiếm dự án | Member | Search projects |
| UC17 | Sửa dự án | Manager | Cập nhật thông tin dự án |
| UC18 | Quản lý thành viên | Manager | Quản lý members |
| UC19 | Thêm thành viên | Manager | Invite member |
| UC20 | Xóa thành viên | Manager | Remove member |
| UC21 | Đổi role thành viên | Manager | Change member role |
| UC22 | Chuyển quyền sở hữu | Manager | Transfer ownership |
| UC23 | Xóa dự án | Admin | Delete project |
| **Task Management** |
| UC24 | Xem Kanban Board | Member | Xem bảng Kanban |
| UC25 | Xem danh sách tasks | Member | Xem list tasks |
| UC26 | Xem chi tiết task | Member | Xem task detail |
| UC31 | Tạo công việc | Member | Create task |
| UC32 | Sửa công việc | Member | Update task |
| UC33 | Kéo thả task | Member | Drag & drop |
| UC34-38 | Quản lý Checklist | Member | CRUD checklist items |
| UC39-44 | Bình luận | Member | CRUD comments + nested replies |
| UC45 | Giao việc | Member | Assign task |
| UC46 | Xóa công việc | Manager | Delete task |
| **Document Management** |
| UC47-58 | Quản lý tài liệu | Member/Manager | CRUD documents |
| **Admin** |
| UC59-71 | Quản trị hệ thống | Admin | System administration |


---

# PHẦN 2: SƠ ĐỒ LUỒNG DỮ LIỆU (DATA FLOW DIAGRAMS - DFD)

## 2.1. SƠ ĐỒ NGỮ CẢNH (CONTEXT DIAGRAM - DFD Level 0)

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                                    SƠ ĐỒ NGỮ CẢNH - DFD LEVEL 0                                            │
│                                                                                                             │
│                                                                                                             │
│                                                                                                             │
│         ┌─────────────┐                                                      ┌─────────────┐               │
│         │             │                                                      │             │               │
│         │    GUEST    │                                                      │   ADMIN     │               │
│         │             │                                                      │             │               │
│         └──────┬──────┘                                                      └──────┬──────┘               │
│                │                                                                    │                       │
│                │  Thông tin đăng ký                                                 │  Quản lý users        │
│                │  Thông tin đăng nhập                                               │  Cài đặt hệ thống     │
│                │  Yêu cầu reset password                                            │  Backup/Restore       │
│                │                                                                    │                       │
│                ▼                                                                    ▼                       │
│         ┌──────────────────────────────────────────────────────────────────────────────────┐               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         │                          HỆ THỐNG TASKFLOW                                       │               │
│         │                                                                                  │               │
│         │                              ┌───────┐                                           │               │
│         │                              │       │                                           │               │
│         │                              │   0   │                                           │               │
│         │                              │       │                                           │               │
│         │                              └───────┘                                           │               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         │                                                                                  │               │
│         └──────────────────────────────────────────────────────────────────────────────────┘               │
│                ▲                                                                    ▲                       │
│                │                                                                    │                       │
│                │  Kết quả xác thực                                                  │  Báo cáo hệ thống     │
│                │  Thông báo lỗi                                                     │  Activity logs        │
│                │  Email reset password                                              │  Thống kê             │
│                │                                                                    │                       │
│         ┌──────┴──────┐                                                      ┌──────┴──────┐               │
│         │             │                                                      │             │               │
│         │   MEMBER    │                                                      │   MANAGER   │               │
│         │             │                                                      │             │               │
│         └──────┬──────┘                                                      └──────┬──────┘               │
│                │                                                                    │                       │
│                │  Thông tin dự án                                                   │  Quản lý dự án        │
│                │  Thông tin công việc                                               │  Quản lý thành viên   │
│                │  Tài liệu upload                                                   │  Báo cáo tiến độ      │
│                │  Bình luận                                                         │                       │
│                │                                                                    │                       │
│                ▼                                                                    ▼                       │
│         ┌──────────────────────────────────────────────────────────────────────────────────┐               │
│         │                                                                                  │               │
│         │                              DATABASE                                            │               │
│         │                                                                                  │               │
│         │    ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐             │               │
│         │    │  Users  │  │Projects │  │  Tasks  │  │Documents│  │Comments │             │               │
│         │    └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘             │               │
│         │                                                                                  │               │
│         └──────────────────────────────────────────────────────────────────────────────────┘               │
│                                                                                                             │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘


CHÚ THÍCH:
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                     │
│   ┌─────────┐                                                                       │
│   │         │   External Entity (Thực thể ngoài) - Actor                           │
│   │  Name   │                                                                       │
│   │         │                                                                       │
│   └─────────┘                                                                       │
│                                                                                     │
│   ┌───────┐                                                                         │
│   │       │                                                                         │
│   │   0   │     Process (Tiến trình) - Hệ thống                                    │
│   │       │                                                                         │
│   └───────┘                                                                         │
│                                                                                     │
│   ─────────►    Data Flow (Luồng dữ liệu)                                          │
│                                                                                     │
│   ═════════     Data Store (Kho dữ liệu)                                           │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2.2. SƠ ĐỒ DFD LEVEL 1 - PHÂN RÃ HỆ THỐNG

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                                         DFD LEVEL 1 - TASKFLOW                                              │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                         ┌─────────┐         │
│    │  GUEST  │                                                                         │  ADMIN  │         │
│    └────┬────┘                                                                         └────┬────┘         │
│         │                                                                                   │               │
│         │ Thông tin đăng nhập/đăng ký                                                       │               │
│         │                                                                                   │               │
│         ▼                                                                                   │               │
│    ┌─────────────────────┐                                                                  │               │
│    │                     │                                                                  │               │
│    │   1.0 QUẢN LÝ       │◄─────────────────────────────────────────────────────────────────┘               │
│    │   TÀI KHOẢN         │  Quản lý users                                                                   │
│    │                     │                                                                                  │
│    └──────────┬──────────┘                                                                                  │
│               │                                                                                             │
│               │ Thông tin user                                                                              │
│               ▼                                                                                             │
│    ═══════════════════════════════════════════════════════════════════════════════════════                  │
│    ║                              D1: USERS                                              ║                  │
│    ═══════════════════════════════════════════════════════════════════════════════════════                  │
│               │                                                                                             │
│               │ User ID, Role                                                                               │
│               ▼                                                                                             │
│    ┌─────────────────────┐         ┌─────────────────────┐         ┌─────────────────────┐                  │
│    │                     │         │                     │         │                     │                  │
│    │   2.0 QUẢN LÝ       │────────>│   3.0 QUẢN LÝ       │────────>│   4.0 QUẢN LÝ       │                  │
│    │   DỰ ÁN             │ Project │   CÔNG VIỆC         │  Task   │   TÀI LIỆU          │                  │
│    │                     │   ID    │                     │   ID    │                     │                  │
│    └──────────┬──────────┘         └──────────┬──────────┘         └──────────┬──────────┘                  │
│               │                               │                               │                             │
│               │                               │                               │                             │
│               ▼                               ▼                               ▼                             │
│    ═══════════════════════      ═══════════════════════      ═══════════════════════                        │
│    ║    D2: PROJECTS    ║      ║     D3: TASKS       ║      ║   D4: DOCUMENTS    ║                        │
│    ═══════════════════════      ═══════════════════════      ═══════════════════════                        │
│               │                               │                               │                             │
│               │                               │                               │                             │
│               │                               ▼                               │                             │
│               │                    ┌─────────────────────┐                    │                             │
│               │                    │                     │                    │                             │
│               │                    │   5.0 QUẢN LÝ       │◄───────────────────┘                             │
│               │                    │   BÌNH LUẬN         │                                                  │
│               │                    │                     │                                                  │
│               │                    └──────────┬──────────┘                                                  │
│               │                               │                                                             │
│               │                               ▼                                                             │
│               │                    ═══════════════════════                                                  │
│               │                    ║    D5: COMMENTS    ║                                                  │
│               │                    ═══════════════════════                                                  │
│               │                                                                                             │
│               │                    ┌─────────────────────┐                                                  │
│               │                    │                     │                                                  │
│               └───────────────────>│   6.0 QUẢN LÝ       │                                                  │
│                                    │   LỊCH & SỰ KIỆN    │                                                  │
│                                    │                     │                                                  │
│                                    └──────────┬──────────┘                                                  │
│                                               │                                                             │
│                                               ▼                                                             │
│                                    ═══════════════════════                                                  │
│                                    ║ D6: CALENDAR_EVENTS║                                                  │
│                                    ═══════════════════════                                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                     ┌─────────────────────┐                                                  │
│    │ MEMBER  │────────────────────>│                     │                                                  │
│    └─────────┘  Thông tin tasks    │   7.0 BÁO CÁO       │                                                  │
│                 Thông tin projects │   THỐNG KÊ          │                                                  │
│    ┌─────────┐                     │                     │                                                  │
│    │ MANAGER │────────────────────>│                     │                                                  │
│    └─────────┘  Yêu cầu báo cáo    └──────────┬──────────┘                                                  │
│                                               │                                                             │
│                                               │ Ghi log                                                     │
│                                               ▼                                                             │
│                                    ═══════════════════════                                                  │
│                                    ║  D7: ACTIVITY_LOGS ║                                                  │
│                                    ═══════════════════════                                                  │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```


---

## 2.3. DFD LEVEL 2 - QUẢN LÝ TÀI KHOẢN (Process 1.0)

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                              DFD LEVEL 2 - PROCESS 1.0: QUẢN LÝ TÀI KHOẢN                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │  GUEST  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Email, Password                                                                                   │
│         ▼                                                                                                   │
│    ┌─────────────────────┐                                                                                  │
│    │                     │                                                                                  │
│    │   1.1 XÁC THỰC      │─────────────────────────────────────────────────────────────────┐                │
│    │   ĐĂNG NHẬP         │                                                                 │                │
│    │                     │                                                                 │                │
│    └──────────┬──────────┘                                                                 │                │
│               │                                                                            │                │
│               │ Query user by email                                                        │                │
│               ▼                                                                            │                │
│    ═══════════════════════                                                                 │                │
│    ║      D1: USERS      ║                                                                 │                │
│    ═══════════════════════                                                                 │                │
│               │                                                                            │                │
│               │ User data                                                                  │                │
│               ▼                                                                            │                │
│    ┌─────────────────────┐                                                                 │                │
│    │                     │                                                                 │                │
│    │   1.2 VERIFY        │                                                                 │                │
│    │   PASSWORD          │                                                                 │                │
│    │   (bcrypt)          │                                                                 │                │
│    └──────────┬──────────┘                                                                 │                │
│               │                                                                            │                │
│               │ Verified                                                                   │                │
│               ▼                                                                            │                │
│    ┌─────────────────────┐         ┌─────────────────────┐                                 │                │
│    │                     │         │                     │                                 │                │
│    │   1.3 TẠO SESSION   │────────>│   1.4 CẬP NHẬT      │                                 │                │
│    │   & REGENERATE ID   │ User ID │   LAST_LOGIN        │                                 │                │
│    │                     │         │                     │                                 │                │
│    └──────────┬──────────┘         └──────────┬──────────┘                                 │                │
│               │                               │                                            │                │
│               │ Session data                  │ Update last_login_at                       │                │
│               ▼                               ▼                                            │                │
│    ═══════════════════════      ═══════════════════════                                    │                │
│    ║    D8: SESSIONS    ║      ║      D1: USERS      ║                                    │                │
│    ═══════════════════════      ═══════════════════════                                    │                │
│                                                                                            │                │
│                                                                                            │                │
│    ┌─────────┐                                                                             │                │
│    │  GUEST  │                                                                             │                │
│    └────┬────┘                                                                             │                │
│         │                                                                                  │                │
│         │ Email, Full name, Password                                                       │                │
│         ▼                                                                                  │                │
│    ┌─────────────────────┐                                                                 │                │
│    │                     │                                                                 │                │
│    │   1.5 VALIDATE      │                                                                 │                │
│    │   REGISTRATION      │                                                                 │                │
│    │                     │                                                                 │                │
│    └──────────┬──────────┘                                                                 │                │
│               │                                                                            │                │
│               │ Check email exists                                                         │                │
│               ▼                                                                            │                │
│    ┌─────────────────────┐                                                                 │                │
│    │                     │                                                                 │                │
│    │   1.6 HASH PASSWORD │                                                                 │                │
│    │   (bcrypt cost 12)  │                                                                 │                │
│    │                     │                                                                 │                │
│    └──────────┬──────────┘                                                                 │                │
│               │                                                                            │                │
│               │ Hashed password                                                            │                │
│               ▼                                                                            │                │
│    ┌─────────────────────┐                                                                 │                │
│    │                     │                                                                 │                │
│    │   1.7 TẠO USER      │─────────────────────────────────────────────────────────────────┘                │
│    │   MỚI               │                                                                                  │
│    │                     │                                                                                  │
│    └──────────┬──────────┘                                                                                  │
│               │                                                                                             │
│               │ Insert new user                                                                             │
│               ▼                                                                                             │
│    ═══════════════════════                                                                                  │
│    ║      D1: USERS      ║                                                                                  │
│    ═══════════════════════                                                                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │  GUEST  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Email                                                                                             │
│         ▼                                                                                                   │
│    ┌─────────────────────┐         ┌─────────────────────┐         ┌─────────────────────┐                  │
│    │                     │         │                     │         │                     │                  │
│    │   1.8 TÌM USER      │────────>│   1.9 TẠO RESET     │────────>│   1.10 GỬI EMAIL   │                  │
│    │   BY EMAIL          │ User ID │   TOKEN             │  Token  │   RESET PASSWORD   │                  │
│    │                     │         │                     │         │                     │                  │
│    └──────────┬──────────┘         └──────────┬──────────┘         └─────────────────────┘                  │
│               │                               │                                                             │
│               │                               │ Save token                                                  │
│               ▼                               ▼                                                             │
│    ═══════════════════════      ═══════════════════════                                                     │
│    ║      D1: USERS      ║      ║      D1: USERS      ║                                                     │
│    ═══════════════════════      ═══════════════════════                                                     │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2.4. DFD LEVEL 2 - QUẢN LÝ CÔNG VIỆC (Process 3.0)

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                              DFD LEVEL 2 - PROCESS 3.0: QUẢN LÝ CÔNG VIỆC                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │ MEMBER  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Project ID, Filter                                                                                │
│         ▼                                                                                                   │
│    ┌─────────────────────┐                                                                                  │
│    │                     │                                                                                  │
│    │   3.1 LẤY DANH SÁCH │                                                                                  │
│    │   TASKS BY PROJECT  │                                                                                  │
│    │                     │                                                                                  │
│    └──────────┬──────────┘                                                                                  │
│               │                                                                                             │
│               │ Query tasks                                                                                 │
│               ▼                                                                                             │
│    ═══════════════════════                                                                                  │
│    ║      D3: TASKS      ║                                                                                  │
│    ═══════════════════════                                                                                  │
│               │                                                                                             │
│               │ Tasks data                                                                                  │
│               ▼                                                                                             │
│    ┌─────────────────────┐                                                                                  │
│    │                     │                                                                                  │
│    │   3.2 NHÓM TASKS    │──────────────────────────────────────────────────────────────────┐               │
│    │   THEO STATUS       │                                                                  │               │
│    │   (Kanban)          │                                                                  │               │
│    └─────────────────────┘                                                                  │               │
│                                                                                             │               │
│                                                                                             │               │
│    ┌─────────┐                                                                              │               │
│    │ MEMBER  │                                                                              │               │
│    └────┬────┘                                                                              │               │
│         │                                                                                   │               │
│         │ Title, Description, Priority, Due date                                            │               │
│         ▼                                                                                   │               │
│    ┌─────────────────────┐         ┌─────────────────────┐         ┌─────────────────────┐  │               │
│    │                     │         │                     │         │                     │  │               │
│    │   3.3 VALIDATE      │────────>│   3.4 TẠO UUID      │────────>│   3.5 LƯU TASK      │  │               │
│    │   TASK DATA         │  Valid  │   CHO TASK          │  UUID   │   VÀO DATABASE      │  │               │
│    │                     │         │                     │         │                     │  │               │
│    └─────────────────────┘         └─────────────────────┘         └──────────┬──────────┘  │               │
│                                                                               │             │               │
│                                                                               │ Insert      │               │
│                                                                               ▼             │               │
│                                                                    ═══════════════════════  │               │
│                                                                    ║      D3: TASKS      ║  │               │
│                                                                    ═══════════════════════  │               │
│                                                                               │             │               │
│                                                                               │ Task ID     │               │
│                                                                               ▼             │               │
│                                                                    ┌─────────────────────┐  │               │
│                                                                    │                     │  │               │
│                                                                    │   3.6 GHI ACTIVITY  │◄─┘               │
│                                                                    │   LOG               │                  │
│                                                                    │                     │                  │
│                                                                    └──────────┬──────────┘                  │
│                                                                               │                             │
│                                                                               │ Log entry                   │
│                                                                               ▼                             │
│                                                                    ═══════════════════════                  │
│                                                                    ║  D7: ACTIVITY_LOGS ║                  │
│                                                                    ═══════════════════════                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │ MEMBER  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Task ID, New Status, New Position                                                                 │
│         ▼                                                                                                   │
│    ┌─────────────────────┐         ┌─────────────────────┐         ┌─────────────────────┐                  │
│    │                     │         │                     │         │                     │                  │
│    │   3.7 VALIDATE      │────────>│   3.8 CẬP NHẬT      │────────>│   3.9 CẬP NHẬT      │                  │
│    │   DRAG & DROP       │  Valid  │   STATUS & POSITION │ Updated │   PROJECT PROGRESS  │                  │
│    │                     │         │                     │         │                     │                  │
│    └─────────────────────┘         └──────────┬──────────┘         └──────────┬──────────┘                  │
│                                               │                               │                             │
│                                               │ Update task                   │ Update progress             │
│                                               ▼                               ▼                             │
│                                    ═══════════════════════      ═══════════════════════                     │
│                                    ║      D3: TASKS      ║      ║    D2: PROJECTS    ║                     │
│                                    ═══════════════════════      ═══════════════════════                     │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │ MEMBER  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Task ID, Assignee ID                                                                              │
│         ▼                                                                                                   │
│    ┌─────────────────────┐         ┌─────────────────────┐         ┌─────────────────────┐                  │
│    │                     │         │                     │         │                     │                  │
│    │   3.10 KIỂM TRA     │────────>│   3.11 THÊM         │────────>│   3.12 TẠO          │                  │
│    │   QUYỀN GIAO VIỆC   │  Valid  │   TASK_ASSIGNEE     │ Success │   NOTIFICATION      │                  │
│    │                     │         │                     │         │                     │                  │
│    └─────────────────────┘         └──────────┬──────────┘         └──────────┬──────────┘                  │
│                                               │                               │                             │
│                                               │ Insert                        │ Insert                      │
│                                               ▼                               ▼                             │
│                                    ═══════════════════════      ═══════════════════════                     │
│                                    ║  D9: TASK_ASSIGNEES║      ║  D10: NOTIFICATIONS║                     │
│                                    ═══════════════════════      ═══════════════════════                     │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```


---

## 2.5. DFD LEVEL 2 - QUẢN LÝ BÌNH LUẬN (Process 5.0)

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│                              DFD LEVEL 2 - PROCESS 5.0: QUẢN LÝ BÌNH LUẬN                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │ MEMBER  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Entity Type, Entity ID                                                                            │
│         ▼                                                                                                   │
│    ┌─────────────────────┐                                                                                  │
│    │                     │                                                                                  │
│    │   5.1 LẤY COMMENTS  │                                                                                  │
│    │   BY ENTITY         │                                                                                  │
│    │                     │                                                                                  │
│    └──────────┬──────────┘                                                                                  │
│               │                                                                                             │
│               │ Query comments                                                                              │
│               ▼                                                                                             │
│    ═══════════════════════                                                                                  │
│    ║    D5: COMMENTS     ║                                                                                  │
│    ═══════════════════════                                                                                  │
│               │                                                                                             │
│               │ All comments (flat)                                                                         │
│               ▼                                                                                             │
│    ┌─────────────────────┐                                                                                  │
│    │                     │                                                                                  │
│    │   5.2 BUILD         │                                                                                  │
│    │   COMMENT TREE      │◄─────────────────────────────────────────────────────────────────┐               │
│    │   (Nested Replies)  │                                                                  │               │
│    │                     │                                                                  │               │
│    └──────────┬──────────┘                                                                  │               │
│               │                                                                             │               │
│               │ Hierarchical comments                                                       │               │
│               ▼                                                                             │               │
│    ┌─────────────────────┐                                                                  │               │
│    │                     │                                                                  │               │
│    │   5.3 TÍNH DEPTH    │                                                                  │               │
│    │   CHO MỖI COMMENT   │                                                                  │               │
│    │                     │                                                                  │               │
│    └─────────────────────┘                                                                  │               │
│                                                                                             │               │
│                                                                                             │               │
│    ┌─────────┐                                                                              │               │
│    │ MEMBER  │                                                                              │               │
│    └────┬────┘                                                                              │               │
│         │                                                                                   │               │
│         │ Content, Entity Type, Entity ID, Parent ID (optional)                             │               │
│         ▼                                                                                   │               │
│    ┌─────────────────────┐                                                                  │               │
│    │                     │                                                                  │               │
│    │   5.4 VALIDATE      │                                                                  │               │
│    │   COMMENT DATA      │                                                                  │               │
│    │                     │                                                                  │               │
│    └──────────┬──────────┘                                                                  │               │
│               │                                                                             │               │
│               │ Valid                                                                       │               │
│               ▼                                                                             │               │
│    ┌─────────────────────┐                                                                  │               │
│    │                     │                                                                  │               │
│    │   5.5 KIỂM TRA      │  (Nếu là reply)                                                  │               │
│    │   PARENT COMMENT    │──────────────────────────────────────────────────────────────────┤               │
│    │   TỒN TẠI           │                                                                  │               │
│    │                     │                                                                  │               │
│    └──────────┬──────────┘                                                                  │               │
│               │                                                                             │               │
│               │ Parent exists                                                               │               │
│               ▼                                                                             │               │
│    ┌─────────────────────┐         ┌─────────────────────┐                                  │               │
│    │                     │         │                     │                                  │               │
│    │   5.6 TẠO UUID      │────────>│   5.7 LƯU COMMENT   │                                  │               │
│    │   CHO COMMENT       │  UUID   │   VÀO DATABASE      │                                  │               │
│    │                     │         │                     │                                  │               │
│    └─────────────────────┘         └──────────┬──────────┘                                  │               │
│                                               │                                             │               │
│                                               │ Insert with parent_id                       │               │
│                                               ▼                                             │               │
│                                    ═══════════════════════                                  │               │
│                                    ║    D5: COMMENTS     ║──────────────────────────────────┘               │
│                                    ═══════════════════════                                                  │
│                                               │                                                             │
│                                               │ Comment ID                                                  │
│                                               ▼                                                             │
│                                    ┌─────────────────────┐                                                  │
│                                    │                     │                                                  │
│                                    │   5.8 TẠO           │                                                  │
│                                    │   NOTIFICATION      │                                                  │
│                                    │   (nếu là reply)    │                                                  │
│                                    │                     │                                                  │
│                                    └──────────┬──────────┘                                                  │
│                                               │                                                             │
│                                               │ Insert notification                                         │
│                                               ▼                                                             │
│                                    ═══════════════════════                                                  │
│                                    ║  D10: NOTIFICATIONS║                                                  │
│                                    ═══════════════════════                                                  │
│                                                                                                             │
│                                                                                                             │
│    ┌─────────┐                                                                                              │
│    │ MEMBER  │                                                                                              │
│    └────┬────┘                                                                                              │
│         │                                                                                                   │
│         │ Comment ID                                                                                        │
│         ▼                                                                                                   │
│    ┌─────────────────────┐         ┌─────────────────────┐                                                  │
│    │                     │         │                     │                                                  │
│    │   5.9 KIỂM TRA      │────────>│   5.10 XÓA COMMENT  │                                                  │
│    │   QUYỀN XÓA         │  Valid  │   (CASCADE REPLIES) │                                                  │
│    │   (owner only)      │         │                     │                                                  │
│    │                     │         │                     │                                                  │
│    └─────────────────────┘         └──────────┬──────────┘                                                  │
│                                               │                                                             │
│                                               │ Delete (ON DELETE CASCADE)                                  │
│                                               ▼                                                             │
│                                    ═══════════════════════                                                  │
│                                    ║    D5: COMMENTS     ║                                                  │
│                                    ═══════════════════════                                                  │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘


NESTED REPLIES ALGORITHM:
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                             │
│   function buildCommentTree(comments, parentId = null):                                                     │
│       result = []                                                                                           │
│       for each comment in comments:                                                                         │
│           if comment.parent_id == parentId:                                                                 │
│               comment.replies = buildCommentTree(comments, comment.id)                                      │
│               comment.depth = calculateDepth(comment)                                                       │
│               result.push(comment)                                                                          │
│       return result                                                                                         │
│                                                                                                             │
│   Ví dụ cấu trúc:                                                                                           │
│   ┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│   │ Comment 1 (depth: 0, parent_id: null)                                                               │   │
│   │   └── Reply 1.1 (depth: 1, parent_id: comment_1)                                                    │   │
│   │       └── Reply 1.1.1 (depth: 2, parent_id: reply_1.1)                                              │   │
│   │       └── Reply 1.1.2 (depth: 2, parent_id: reply_1.1)                                              │   │
│   │   └── Reply 1.2 (depth: 1, parent_id: comment_1)                                                    │   │
│   │ Comment 2 (depth: 0, parent_id: null)                                                               │   │
│   │   └── Reply 2.1 (depth: 1, parent_id: comment_2)                                                    │   │
│   └─────────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2.6. BẢNG TỪ ĐIỂN DỮ LIỆU (DATA DICTIONARY)

### Data Stores (Kho dữ liệu)

| Mã | Tên | Mô tả | Bảng CSDL |
|----|-----|-------|-----------|
| D1 | USERS | Thông tin người dùng | users |
| D2 | PROJECTS | Thông tin dự án | projects |
| D3 | TASKS | Thông tin công việc | tasks |
| D4 | DOCUMENTS | Thông tin tài liệu | documents |
| D5 | COMMENTS | Bình luận | comments |
| D6 | CALENDAR_EVENTS | Sự kiện lịch | calendar_events |
| D7 | ACTIVITY_LOGS | Lịch sử hoạt động | activity_logs |
| D8 | SESSIONS | Phiên đăng nhập | PHP Sessions |
| D9 | TASK_ASSIGNEES | Người được giao task | task_assignees |
| D10 | NOTIFICATIONS | Thông báo | notifications |

### Data Flows (Luồng dữ liệu)

| Luồng | Từ | Đến | Dữ liệu |
|-------|-----|-----|---------|
| Thông tin đăng nhập | Guest | Process 1.1 | email, password |
| User data | D1: USERS | Process 1.2 | id, email, password_hash, role, is_active |
| Session data | Process 1.3 | D8: SESSIONS | user_id, user_role, user_name |
| Task data | Member | Process 3.3 | title, description, priority, due_date, project_id |
| Comment data | Member | Process 5.4 | content, entity_type, entity_id, parent_id |
| Notification | Process 5.8 | D10: NOTIFICATIONS | user_id, type, title, message |

### External Entities (Thực thể ngoài)

| Tên | Mô tả | Tương tác |
|-----|-------|-----------|
| Guest | Khách chưa đăng nhập | Đăng nhập, đăng ký, quên mật khẩu |
| Member | Thành viên | CRUD tasks, documents, comments |
| Manager | Quản lý | Quản lý dự án, thành viên, báo cáo |
| Admin | Quản trị viên | Quản lý users, cài đặt hệ thống |

---

## 2.7. CHÚ THÍCH KÝ HIỆU DFD

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              CHÚ THÍCH KÝ HIỆU DFD                                  │
└─────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐
│             │     External Entity (Thực thể ngoài)
│    Name     │     - Nguồn hoặc đích của dữ liệu
│             │     - Nằm ngoài phạm vi hệ thống
└─────────────┘

┌─────────────────────┐
│                     │
│   X.X Process Name  │     Process (Tiến trình)
│                     │     - Xử lý, biến đổi dữ liệu
└─────────────────────┘     - X.X là số hiệu tiến trình

═══════════════════════
║    DX: Data Store   ║     Data Store (Kho dữ liệu)
═══════════════════════     - Nơi lưu trữ dữ liệu
                            - DX là mã kho dữ liệu

─────────────────────►      Data Flow (Luồng dữ liệu)
    Data description        - Hướng di chuyển của dữ liệu
                            - Mô tả dữ liệu truyền đi

Quy tắc đánh số:
- Level 0: Một process duy nhất (0)
- Level 1: 1.0, 2.0, 3.0, ...
- Level 2: 1.1, 1.2, 1.3, ... (phân rã từ 1.0)
           2.1, 2.2, 2.3, ... (phân rã từ 2.0)
```

